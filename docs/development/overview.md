# Rubick 项目概述

## 项目简介

Rubick 是一个开源的插件化桌面端效率工具箱，基于 Electron 和 Vue.js 构建。它采用插件化架构，允许用户通过安装各种插件来扩展功能，支持多平台（Windows、macOS、Linux）运行。

### 核心特性

- **插件化架构**：基于 npm 包模式的插件管理，安装插件和安装 npm 包一样简单
- **多平台支持**：支持 Windows、macOS 和 Linux 系统
- **WebDAV 同步**：支持多端数据同步，确保数据安全
- **系统插件模式**：独特的系统插件模式，让插件成为 Rubick 的一部分
- **快速启动**：支持快速启动本地应用、文件和文件夹
- **企业级部署**：支持企业内网部署和定制化开发
- **多语言支持**：支持多种语言界面

## 技术栈

### 前端技术

- **Vue 3**：用于构建用户界面
- **TypeScript**：提供类型安全和更好的开发体验
- **Ant Design Vue**：UI 组件库
- **Less**：CSS 预处理器

### 后端技术

- **Electron**：跨平台桌面应用框架
- **Node.js**：运行时环境
- **PouchDB**：本地数据库，支持数据同步
- **WebDAV**：用于多端数据同步

### 开发工具

- **Vue CLI**：项目脚手架和构建工具
- **Electron Builder**：应用打包和分发
- **ESLint**：代码质量检查
- **Prettier**：代码格式化

## 项目结构

```
rubick/
├── docs/                    # 文档目录
├── public/                  # 静态资源
├── release/                 # 发布相关文件
├── src/                     # 源代码目录
│   ├── common/              # 公共模块
│   │   ├── constans/        # 常量定义
│   │   └── utils/           # 工具函数
│   ├── core/                # 核心功能模块
│   │   ├── app-search/      # 应用搜索
│   │   ├── db/              # 数据库操作
│   │   ├── plugin-handler/  # 插件处理
│   │   └── screen-capture/  # 截图功能
│   ├── main/                # 主进程代码
│   │   ├── browsers/        # 浏览器窗口管理
│   │   └── common/          # 主进程公共模块
│   └── renderer/            # 渲染进程代码
│       ├── components/      # Vue 组件
│       ├── plugins-manager/ # 插件管理
│       └── views/           # 页面视图
├── detach/                  # 独立窗口应用
├── feature/                 # 功能模块
├── guide/                   # 引导页面
└── tpl/                     # 模板页面
```

## 核心模块

### 1. 应用启动与生命周期管理

**文件位置**：[`src/main/index.ts`](../../src/main/index.ts:1)

负责应用的启动、窗口管理和生命周期控制。主要功能包括：

- 单实例检查
- 主窗口创建
- 系统托盘管理
- 全局快捷键注册
- 应用退出处理

### 2. 插件系统

**文件位置**：[`src/core/plugin-handler/index.ts`](../../src/core/plugin-handler/index.ts:1)

插件系统的核心实现，负责插件的安装、卸载、更新和管理。主要功能包括：

- 插件安装和卸载
- 插件信息获取
- 插件版本管理
- 插件源配置

### 3. 数据库系统

**文件位置**：[`src/core/db/index.ts`](../../src/core/db/index.ts:1)

基于 PouchDB 的本地数据库系统，支持数据存储和同步。主要功能包括：

- 本地数据存储
- 文档 CRUD 操作
- WebDAV 数据同步
- 附件管理

### 4. API 系统

**文件位置**：[`src/main/common/api.ts`](../../src/main/common/api.ts:1)

主进程和渲染进程之间的通信桥梁，提供各种系统 API。主要功能包括：

- 窗口管理
- 插件加载和卸载
- 系统通知
- 剪贴板操作
- 文件系统访问

### 5. 搜索系统

**文件位置**：[`src/renderer/plugins-manager/options.ts`](../../src/renderer/plugins-manager/options.ts:1)

实现应用、插件和文件的搜索功能。主要功能包括：

- 应用搜索
- 插件搜索
- 文件搜索
- 拼音搜索支持
- 搜索结果排序

## 插件架构

### 插件类型

Rubick 支持两种类型的插件：

1. **UI 插件**：在 Rubick 主界面中运行的插件
   - 安装后立即可用
   - 通常用于特定功能操作
   - 运行在独立的 BrowserView 中

2. **系统插件**：集成到 Rubick 系统中的插件
   - 需要重启 Rubick 后生效
   - 通常提供系统级功能增强
   - 可以修改 Rubick 的核心行为

### 插件生命周期

1. **安装**：通过插件市场或 npm 安装
2. **加载**：启动时或按需加载插件
3. **运行**：执行插件功能
4. **卸载**：从系统中移除插件

### 插件通信

- **主进程通信**：通过 IPC 与主进程通信
- **渲染进程通信**：通过事件系统与主界面通信
- **插件间通信**：通过共享 API 或事件系统

## 数据流

### 搜索流程

1. 用户输入搜索关键词
2. 搜索系统处理关键词
3. 并行搜索应用、插件和文件
4. 结果排序和过滤
5. 显示搜索结果

### 插件执行流程

1. 用户选择插件功能
2. 主进程加载插件
3. 创建插件运行环境
4. 执行插件逻辑
5. 返回结果或显示界面

### 数据同步流程

1. 用户触发同步操作
2. 导出本地数据
3. 上传到 WebDAV 服务器
4. 其他设备下载数据
5. 导入到本地数据库

## 安全机制

### 插件安全

- **沙箱环境**：插件运行在受限环境中
- **权限控制**：插件只能访问授权的 API
- **代码审查**：官方插件经过安全审查

### 数据安全

- **本地加密**：敏感数据本地加密存储
- **安全传输**：WebDAV 同步使用 HTTPS
- **隐私保护**：不收集用户隐私数据

## 性能优化

### 启动优化

- **延迟加载**：非核心功能延迟加载
- **缓存机制**：缓存常用数据和资源
- **预编译**：提前编译常用模板

### 运行时优化

- **内存管理**：及时释放不用的资源
- **事件优化**：减少不必要的事件监听
- **渲染优化**：优化 DOM 操作和重绘

## 扩展性设计

### 插件扩展

- **标准 API**：提供丰富的插件 API
- **事件系统**：支持插件间通信
- **配置系统**：灵活的插件配置机制

### 平台扩展

- **模块化设计**：平台特定功能模块化
- **适配器模式**：不同平台的适配器
- **条件编译**：平台特定的代码编译

## 开发环境

### 环境要求

- Node.js 14.0+
- npm 6.0+
- Git

### 开发工具

- VS Code（推荐）
- Chrome DevTools
- Electron DevTools

### 调试方法

- 主进程调试：使用 VS Code 调试配置
- 渲染进程调试：使用 Chrome DevTools
- 插件调试：使用 Electron DevTools

## 相关资源

- [GitHub 仓库](https://github.com/rubickCenter/rubick)
- [Rubick 官网](https://rubick.vip)
- [插件仓库](https://gitee.com/rubick-center)
- [插件开发指南](./plugin-development.md)
- [API 文档](./api.md)